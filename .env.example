# OAuth Server Configuration

# Environment (development, staging, production)
# CRITICAL: Set to "production" in production environments
ENVIRONMENT=development

# Server Configuration
SERVER_HOST=localhost
SERVER_PORT=8080
READ_TIMEOUT=10s
WRITE_TIMEOUT=10s
IDLE_TIMEOUT=60s

# Database Configuration
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=your_password_here
DB_NAME=oauth_server
DB_SSL_MODE=disable

# Database Connection Pool (optional, defaults shown)
# DB_MAX_OPEN_CONNS=25
# DB_MAX_IDLE_CONNS=5
# DB_CONN_MAX_LIFETIME=30m
# DB_CONN_MAX_IDLE_TIME=5m

# JWT Configuration
# CRITICAL: Generate with: openssl rand -base64 32
# REQUIRED in production (min 32 characters)
JWT_SECRET=your-super-secure-jwt-secret-key-here-change-this-in-production

# Token TTL Configuration
ACCESS_TOKEN_TTL=15m
REFRESH_TOKEN_TTL=168h  # 7 days
AUTH_CODE_TTL=10m

# Security Configuration
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=1m
RATE_LIMIT_BACKEND=memory  # "memory" or "redis" (use redis for distributed deployments)
ALLOWED_ORIGINS=*
MAX_REQUEST_SIZE=1048576  # 1MB

# CSRF Protection (recommended for production)
ENABLE_CSRF=false
# CSRF_SECRET=your-csrf-secret-here-min-32-characters

# Password Requirements
MIN_PASSWORD_LENGTH=8

# Pwned Passwords (HaveIBeenPwned integration)
PWNED_PASSWORDS_ENABLED=true
PWNED_PASSWORDS_TIMEOUT=5s
PWNED_PASSWORDS_FAIL_OPEN=true  # If true, allow password on API errors

# HTTPS Enforcement (set to true in production)
REQUIRE_HTTPS=false

# TLS Configuration (optional, for HTTPS)
# TLS_CERT=/path/to/cert.pem
# TLS_KEY=/path/to/key.pem

# Base URL (optional, auto-detected if not set)
# BASE_URL=https://oauth.yourdomain.com

# Redis Configuration (required if RATE_LIMIT_BACKEND=redis or caching enabled)
REDIS_ENABLED=false
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_POOL_SIZE=10

# Example production values (single server):
# ENVIRONMENT=production
# JWT_SECRET=a-very-long-random-string-at-least-32-characters-long
# DB_PASSWORD=secure_database_password
# ALLOWED_ORIGINS=https://yourdomain.com,https://app.yourdomain.com
# ENABLE_CSRF=true
# CSRF_SECRET=another-long-random-string-at-least-32-characters
# REQUIRE_HTTPS=true
# RATE_LIMIT_BACKEND=memory
# PWNED_PASSWORDS_ENABLED=true
# PWNED_PASSWORDS_FAIL_OPEN=false
# TLS_CERT=/etc/ssl/certs/oauth-server.crt
# TLS_KEY=/etc/ssl/private/oauth-server.key

# Example production values (distributed/multi-server):
# ENVIRONMENT=production
# JWT_SECRET=a-very-long-random-string-at-least-32-characters-long
# DB_PASSWORD=secure_database_password
# RATE_LIMIT_BACKEND=redis
# REDIS_ENABLED=true
# REDIS_HOST=redis.internal.example.com
# REDIS_PASSWORD=redis-secure-password
# ALLOWED_ORIGINS=https://yourdomain.com,https://app.yourdomain.com
# ENABLE_CSRF=true
# CSRF_SECRET=another-long-random-string-at-least-32-characters
# REQUIRE_HTTPS=true
# PWNED_PASSWORDS_ENABLED=true
# PWNED_PASSWORDS_FAIL_OPEN=false